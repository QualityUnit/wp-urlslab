import{r as I,R as s,L as $}from"../main.js";import{u as y,a as M,h as R,T as h,S as L,M as P,b as B}from"./useTableUpdater-d1cf60b0.js";import{C as D,S as U}from"./datepicker-a249e83b.js";import"./useMutation-2de0e287.js";function q({slug:i}){var f;const{table:m,setTable:w,filters:n,setFilters:S,currentFilters:b,sortingColumn:d,sortBy:E,row:u,deleteRow:_,updateRow:z}=y({slug:i}),g=I.useMemo(()=>`${n}${d}`,[n,d]),l="fileid",{__:a,columnHelper:t,data:c,status:V,isSuccess:F,isFetchingNextPage:p,hasNextPage:x,ref:T}=M({key:i,url:g,pageId:l,currentFilters:b,sortingColumn:d}),k={N:a("New"),A:a("Available"),P:a("Processing"),D:a("Disabled")},r={filename:a("File Name"),filetype:a("File Type"),status_changed:a("Status changed"),filestatus:a("Status"),height:a("Height"),width:a("Width"),filesize:a("File Size"),file_usage_count:a("File Usage"),url:a("URL")},N=[t.accessor("check",{className:"checkbox",cell:e=>s.createElement(D,{checked:e.row.getIsSelected(),onChange:o=>{R(o,e)}}),header:null}),t==null?void 0:t.accessor("filename",{tooltip:e=>s.createElement(h,null,e.getValue()),header:r.filename,size:150}),t==null?void 0:t.accessor("filetype",{header:r.filetype,size:80}),t==null?void 0:t.accessor("filestatus",{className:"nolimit",cell:e=>s.createElement(U,{items:k,name:e.column.id,checkedId:e.getValue(),onChange:o=>z({data:c,newVal:o,url:g,slug:i,cell:e,rowSelector:l})}),header:r.filestatus,size:100}),t==null?void 0:t.accessor("status_changed",{cell:e=>new Date(e==null?void 0:e.getValue()).toLocaleString(window.navigator.language),header:()=>a("Status changed"),size:100}),t==null?void 0:t.accessor("width",{cell:e=>`${e.getValue()} px`,header:r.width,size:50}),t==null?void 0:t.accessor("height",{cell:e=>`${e.getValue()} px`,header:r.height,size:50}),t==null?void 0:t.accessor("filesize",{cell:e=>`${Math.round(e.getValue()/1024,0)} kB`,header:r.filesize,size:80}),t==null?void 0:t.accessor("file_usage_count",{header:r.file_usage_count,size:80}),t==null?void 0:t.accessor("url",{tooltip:e=>{const o=/(jpeg|jpg|webp|gif|png|svg)/g,C=e.getValue().search(o);return s.createElement(h,null,C!==-1&&s.createElement("img",{src:e.getValue(),alt:"url"}))},cell:e=>s.createElement("a",{href:e.getValue(),title:e.getValue(),target:"_blank",rel:"noreferrer"},e.getValue()),header:r.url,size:250}),t.accessor("delete",{className:"deleteRow",cell:e=>s.createElement(L,{onClick:()=>_({data:c,url:g,slug:i,cell:e,rowSelector:l})}),header:null})];return V==="loading"?s.createElement($,null):s.createElement(s.Fragment,null,s.createElement(P,{slug:i,header:r,table:m,onSort:e=>E(e),onFilter:e=>S(e),exportOptions:{url:i,filters:n,fromId:`from_${l}`,pageId:l,deleteCSVCols:[l,"dest_url_id"]}}),s.createElement(B,{className:"fadeInto",slug:i,returnTable:e=>w(e),columns:N,data:F&&((f=c==null?void 0:c.pages)==null?void 0:f.flatMap(e=>e??[]))},u?s.createElement(h,{center:!0},`${r.filename} “${u.filename}”`," ",a("has been deleted.")):null,s.createElement("button",{ref:T},p?"Loading more...":x)))}export{q as default};
