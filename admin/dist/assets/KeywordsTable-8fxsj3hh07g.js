import{a as v,l as $,R as t,r as O,L as Q}from"../main-8fxsj3hh07g.js";import{u as q,a as D,b as P,T as _,S as j,M as B,c as H}from"./useTableUpdater-8fxsj3hh07g.js";import{S as C,I as g,C as K}from"./datepicker-8fxsj3hh07g.js";import"./useMutation-8fxsj3hh07g.js";function L({noAll:o,isFilter:i,children:f,onChange:w,checkedId:n,autoClose:u}){const c=v(),d=c.getQueryData(["languages"]),p=a=>Object.fromEntries(Object.entries(a).sort(([,l],[,m])=>l.localeCompare(m)));o&&delete d.all,d[n]||(d[n]=$(n),c.setQueryData(["languages"],p(d)),c.invalidateQueries(["languages"]));const h=p(d),k=a=>{w&&w(a)};return h?t.createElement(C,{autoClose:u,items:h,isFilter:i,name:"languages",checkedId:n,onChange:a=>k(a)},f):t.createElement(g,{defaultValue:n,onChange:a=>k(a)})}function W({slug:o}){var T;const i="kw_id",{table:f,setTable:w,rowToInsert:n,setInsertRow:u,filters:c,setFilters:d,sortingColumn:p,sortBy:h}=q({slug:o}),k=O.useMemo(()=>`${c}${p}`,[c,p]),{__:a,columnHelper:l,data:m,status:V,isSuccess:F,isFetchingNextPage:I,hasNextPage:z,ref:N}=D({key:o,url:k,pageId:i}),{row:E,rowsSelected:R,selectRow:S,deleteRow:M,updateRow:y}=P({data:m,url:k,slug:o,pageId:i}),b={M:a("Manual"),I:a("Imported"),X:a("None")},r={keyword:a("Keyword"),kwType:a("Type"),kw_length:a("Length"),kw_priority:a("Priority"),kw_usage_count:a("Usage"),lang:a("Language"),link_usage_count:a("Link Usage"),urlFilter:a("URL Filter"),urlLink:a("Link")},x={keyword:t.createElement(g,{liveUpdate:!0,defaultValue:"",label:r.keyword,onChange:e=>u({...n,keyword:e}),required:!0}),kwType:t.createElement(C,{autoClose:!0,items:b,name:"kwType",checkedId:"M",onChange:e=>u({...n,kwType:e})},r.kwType),kw_priority:t.createElement(g,{liveUpdate:!0,type:"number",defaultValue:"0",min:"0",max:"255",label:r.kw_priority,onChange:e=>u({...n,kw_priority:e})}),lang:t.createElement(L,{autoClose:!0,checkedId:"all",onChange:e=>u({...n,lang:e})},a("Language")),urlFilter:t.createElement(g,{liveUpdate:!0,defaultValue:"",label:r.urlFilter,onChange:e=>u({...n,urlFilter:e})}),urlLink:t.createElement(g,{liveUpdate:!0,type:"url",defaultValue:"",label:r.urlLink,onChange:e=>u({...n,urlLink:e}),required:!0})},U=[l.accessor("check",{className:"checkbox",cell:e=>t.createElement(K,{checked:e.row.getIsSelected(),onChange:s=>{S(s,e)}}),header:null,enableResizing:!1}),l.accessor("keyword",{tooltip:e=>t.createElement(_,null,e.getValue()),header:r.keyword,minSize:150}),l.accessor("kwType",{className:"nolimit",cell:e=>t.createElement(C,{items:b,name:e.column.id,checkedId:e.getValue(),onChange:s=>y({newVal:s,cell:e})}),header:r.kwType,size:100}),l.accessor("kw_length",{header:r.kw_length,size:80}),l.accessor("kw_priority",{className:"nolimit",cell:e=>t.createElement(g,{type:"number",defaultValue:e.getValue(),onChange:s=>y({newVal:s,cell:e})}),header:r.kw_priority,size:80}),l.accessor("lang",{className:"nolimit",cell:e=>t.createElement(L,{checkedId:e==null?void 0:e.getValue(),onChange:s=>y({newVal:s,cell:e})}),header:r.lang,size:165}),l.accessor("kw_usage_count",{header:r.kw_usage_count,size:70}),l.accessor("link_usage_count",{header:r.link_usage_count,size:100}),l.accessor("urlFilter",{className:"nolimit",cell:e=>t.createElement(g,{defaultValue:e.renderValue(),onChange:s=>y({newVal:s,cell:e})}),header:r.urlFilter,size:100}),l.accessor("urlLink",{tooltip:e=>t.createElement(_,null,e.getValue()),cell:e=>t.createElement("a",{href:e.getValue(),target:"_blank",rel:"noreferrer"},e.getValue()),header:r.urlLink,enableResizing:!1,size:350}),l.accessor("delete",{className:"deleteRow",cell:e=>t.createElement(j,{onClick:()=>M({cell:e})}),header:null})];return V==="loading"?t.createElement(Q,null):t.createElement(t.Fragment,null,t.createElement(B,{slug:o,header:r,table:f,rowsSelected:R,onSort:e=>h(e),onFilter:e=>d(e),insertOptions:{inserterCells:x,title:"Add keyword",data:m,slug:o,url:k,pageId:i,rowToInsert:n},exportOptions:{url:o,filters:c,fromId:`from_${i}`,pageId:i,deleteCSVCols:[i,"dest_url_id"]}}),t.createElement(H,{className:"fadeInto",slug:o,returnTable:e=>w(e),columns:U,data:F&&((T=m==null?void 0:m.pages)==null?void 0:T.flatMap(e=>e??[]))},E?t.createElement(_,{center:!0},`${r.keyword} “${E.keyword}”`," ",a("has been deleted.")):null,t.createElement("button",{ref:N},I?"Loading more...":z)))}export{W as default};
