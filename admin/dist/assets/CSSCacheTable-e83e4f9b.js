import{r as F,R as a,L as M}from"../main.js";import{u as R,a as V,h as $,T as g,S as L,M as P,b as y}from"./useTableUpdater-996b53f6.js";import{C as B,S as D}from"./datepicker-9d5f36ac.js";import"./useMutation-157cd200.js";function q({slug:r}){var h;const{table:f,setTable:S,filters:l,setFilters:b,sortingColumn:i,currentFilters:w,sortBy:E,row:m,deleteRow:_,updateRow:p}=R({slug:r}),d=F.useMemo(()=>`${l}${i}`,[l,i]),o="url_id",{__:s,columnHelper:t,data:c,status:C,isSuccess:T,isFetchingNextPage:k,hasNextPage:z,ref:I}=V({key:r,url:d,pageId:o,currentFilters:w,sortingColumn:i}),N={N:s("New"),A:s("Available"),P:s("Processing"),D:s("Disabled")},n={url:s("URL"),status:s("Status"),status_changed:s("Status changed"),filesize:s("Filesize")},x=[t.accessor("check",{className:"checkbox",cell:e=>a.createElement(B,{checked:e.row.getIsSelected(),onChange:u=>{$(u,e)}}),header:null}),t==null?void 0:t.accessor("url",{tooltip:e=>a.createElement(g,null,e.getValue()),header:n.url,size:450}),t==null?void 0:t.accessor("status",{className:"nolimit",cell:e=>a.createElement(D,{items:N,name:e.column.id,checkedId:e.getValue(),onChange:u=>p({data:c,newVal:u,url:d,slug:r,cell:e,rowSelector:o})}),header:n.status,size:100}),t==null?void 0:t.accessor("status_changed",{cell:e=>new Date(e==null?void 0:e.getValue()).toLocaleString(window.navigator.language),header:n.status_changed,size:100}),t==null?void 0:t.accessor("filesize",{cell:e=>`${Math.round(e.getValue()/1024,0)} kB`,header:n.filesize,size:100}),t.accessor("delete",{className:"deleteRow",cell:e=>a.createElement(L,{onClick:()=>_({data:c,url:d,slug:r,cell:e,rowSelector:o})}),header:null})];return C==="loading"?a.createElement(M,null):a.createElement(a.Fragment,null,a.createElement(P,{slug:r,header:n,table:f,noImport:!0,onSort:e=>E(e),onFilter:e=>b(e),exportOptions:{url:r,filters:l,fromId:`from_${o}`,pageId:o,deleteCSVCols:[o,"dest_url_id"]}}),a.createElement(y,{className:"fadeInto",columns:x,slug:r,returnTable:e=>S(e),data:T&&((h=c==null?void 0:c.pages)==null?void 0:h.flatMap(e=>e??[]))},m?a.createElement(g,{center:!0},`${n.url_name} “${m.url_name}”`," ",s("has been deleted.")):null,a.createElement("button",{ref:I},k?"Loading more...":z)))}export{q as default};
