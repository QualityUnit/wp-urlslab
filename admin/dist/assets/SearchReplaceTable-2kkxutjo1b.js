import{r as U,R as t,L as $}from"../main-2kkxutjo1b.js";import{u as v,a as z,b as L,S as P,M as q,c as B,T as H}from"./useTableUpdater-2kkxutjo1b.js";import{C as O,I as o,S as E}from"./datepicker-2kkxutjo1b.js";import"./useMutation-2kkxutjo1b.js";function J({slug:l}){var C;const s="id",{table:y,setTable:b,rowToInsert:i,setInsertRow:m,filters:h,setFilters:T,sortingColumn:_,sortBy:R}=v({slug:l}),p=U.useMemo(()=>`${h}${_}`,[h,_]),{__:c,columnHelper:n,data:u,status:x,isSuccess:I,isFetchingNextPage:V,hasNextPage:S,ref:w}=z({key:l,url:p,pageId:s}),{row:f,selectRow:N,deleteRow:k,updateRow:d}=L({data:u,url:p,slug:l,pageId:s}),g={T:c("Plain Text"),R:c("Regular Expr.")},a={str_search:c("Search string"),str_replace:c("Replace string"),search_type:c("Search Type"),url_filter:"URL Filter"},F={str_search:t.createElement(o,{liveUpdate:!0,type:"url",defaultValue:"",label:a.str_search,onChange:e=>m({...i,str_search:e}),required:!0}),str_replace:t.createElement(o,{liveUpdate:!0,type:"url",defaultValue:"",label:a.str_replace,onChange:e=>m({...i,str_replace:e}),required:!0}),search_type:t.createElement(E,{autoClose:!0,items:g,name:"search_type",checkedId:"T",onChange:e=>m({...i,search_type:e})},a.search_type),url_filter:t.createElement(o,{liveUpdate:!0,defaultValue:"",label:a.url_filter,onChange:e=>m({...i,url_filter:e})})},M=[n.accessor("check",{className:"nolimit checkbox",cell:e=>t.createElement(O,{checked:e.row.getIsSelected(),onChange:r=>{N(r,e)}}),header:null}),n.accessor("str_search",{className:"nolimit",cell:e=>t.createElement(o,{type:"text",defaultValue:e.getValue(),onChange:r=>d({newVal:r,cell:e})}),header:a.str_search,size:300}),n.accessor("str_replace",{className:"nolimit",cell:e=>t.createElement(o,{type:"text",defaultValue:e.getValue(),onChange:r=>d({newVal:r,cell:e})}),header:a.str_replace,size:300}),n.accessor("search_type",{className:"nolimit",cell:e=>t.createElement(E,{items:g,name:e.column.id,checkedId:e.getValue(),onChange:r=>d({newVal:r,cell:e})}),header:a.search_type,size:100}),n.accessor("url_filter",{className:"nolimit",cell:e=>t.createElement(o,{type:"text",defaultValue:e.getValue(),onChange:r=>d({newVal:r,cell:e})}),header:a.url_filter,size:100}),n.accessor("delete",{className:"deleteRow",cell:e=>t.createElement(P,{onClick:()=>k({cell:e})}),header:()=>null})];return x==="loading"?t.createElement($,null):t.createElement(t.Fragment,null,t.createElement(q,{slug:l,header:a,table:y,onSort:e=>R(e),onFilter:e=>T(e),insertOptions:{inserterCells:F,title:"Add replacement",data:u,slug:l,url:p,pageId:s,rowToInsert:i},exportOptions:{url:l,filters:h,fromId:`from_${s}`,pageId:s,deleteCSVCols:[s,"dest_url_id"]}}),t.createElement(B,{className:"fadeInto",slug:l,returnTable:e=>b(e),columns:M,data:I&&((C=u==null?void 0:u.pages)==null?void 0:C.flatMap(e=>e??[]))},f?t.createElement(H,{center:!0},`${a.str_search} “${f.str_search}”`," ",c("has been deleted.")):null,t.createElement("button",{ref:w},V?"Loading more...":S)))}export{J as default};
