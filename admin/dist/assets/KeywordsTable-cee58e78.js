import{a as S,l as I,R as t,r as M,L as x}from"../main.js";import{u as $,a as Q,b as U,T as f,S as D,M as O,c as P}from"./useTableUpdater-9aec7406.js";import{S as b,I as _,C as j}from"./datepicker-e55fd098.js";import"./useMutation-cf66945e.js";function v({noAll:o,isFilter:i,children:p,onChange:d,checkedId:s}){const m=S(),c=m.getQueryData(["languages"]),h=a=>Object.fromEntries(Object.entries(a).sort(([,u],[,w])=>u.localeCompare(w)));o&&delete c.all,c[s]||(c[s]=I(s),m.setQueryData(["languages"],h(c)),m.invalidateQueries(["languages"]));const g=h(c),n=a=>{d&&d(a)};return g?t.createElement(b,{items:g,isFilter:i,name:"languages",checkedId:s,onChange:a=>n(a)},p):t.createElement(_,{defaultValue:s,onChange:a=>n(a)})}function X({slug:o}){var E;const i="kw_id",{table:p,setTable:d,filters:s,setFilters:m,sortingColumn:c,sortBy:h}=$({slug:o}),g=M.useMemo(()=>`${s}${c}`,[s,c]),{__:n,columnHelper:a,data:u,status:w,isSuccess:C,isFetchingNextPage:L,hasNextPage:T,ref:V}=Q({key:o,url:g,pageId:i}),{row:y,selectRow:z,deleteRow:N,updateRow:k}=U({data:u,url:g,slug:o,pageId:i}),F={M:n("Manual"),I:n("Imported"),X:n("None")},r={keyword:n("Keyword"),kwType:n("Type"),kw_length:n("Length"),kw_priority:n("Priority"),kw_usage_count:n("Usage"),lang:n("Language"),link_usage_count:n("Link Usage"),urlFilter:n("URL Filter"),urlLink:n("Link")},R=[a.accessor("check",{className:"checkbox",cell:e=>t.createElement(j,{checked:e.row.getIsSelected(),onChange:l=>{z(l,e)}}),header:null,enableResizing:!1}),a.accessor("keyword",{tooltip:e=>t.createElement(f,null,e.getValue()),header:r.keyword,minSize:150}),a.accessor("kwType",{className:"nolimit",cell:e=>t.createElement(b,{items:F,name:e.column.id,checkedId:e.getValue(),onChange:l=>k({newVal:l,cell:e})}),header:r.kwType,size:100}),a.accessor("kw_length",{header:r.kw_length,size:80}),a.accessor("kw_priority",{className:"nolimit",cell:e=>t.createElement(_,{type:"number",defaultValue:e.getValue(),onChange:l=>k({newVal:l,cell:e})}),header:r.kw_priority,size:80}),a.accessor("lang",{className:"nolimit",cell:e=>t.createElement(v,{checkedId:e==null?void 0:e.getValue(),onChange:l=>k({newVal:l,cell:e})}),header:r.lang,size:165}),a.accessor("kw_usage_count",{header:r.kw_usage_count,size:70}),a.accessor("link_usage_count",{header:r.link_usage_count,size:100}),a.accessor("urlFilter",{className:"nolimit",cell:e=>t.createElement(_,{defaultValue:e.renderValue(),onChange:l=>k({newVal:l,cell:e})}),header:r.urlFilter,size:100}),a.accessor("urlLink",{tooltip:e=>t.createElement(f,null,e.getValue()),cell:e=>t.createElement("a",{href:e.getValue(),target:"_blank",rel:"noreferrer"},e.getValue()),header:r.urlLink,enableResizing:!1,size:350}),a.accessor("delete",{className:"deleteRow",cell:e=>t.createElement(D,{onClick:()=>N({cell:e})}),header:null})];return w==="loading"?t.createElement(x,null):t.createElement(t.Fragment,null,t.createElement(O,{slug:o,header:r,table:p,onSort:e=>h(e),onFilter:e=>m(e),exportOptions:{url:o,filters:s,fromId:`from_${i}`,pageId:i,deleteCSVCols:[i,"dest_url_id"]}}),t.createElement(P,{className:"fadeInto",slug:o,returnTable:e=>d(e),columns:R,data:C&&((E=u==null?void 0:u.pages)==null?void 0:E.flatMap(e=>e??[]))},y?t.createElement(f,{center:!0},`${r.keyword} “${y.keyword}”`," ",n("has been deleted.")):null,t.createElement("button",{ref:V},L?"Loading more...":T)))}export{X as default};
