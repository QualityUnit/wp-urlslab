import{r as F,R as t,L as M}from"../main.js";import{u as N,a as V,h as z,T as m,S as L,M as R,b as $}from"./useTableUpdater-93621fab.js";import{C as y}from"./datepicker-9d5f36ac.js";import"./useMutation-157cd200.js";function O({slug:a}){var i;const{table:u,setTable:g,filters:s,setFilters:p,currentFilters:_,sortingColumn:d,sortBy:f,row:C,deleteRow:b}=N({slug:a}),h=F.useMemo(()=>`${s}${d}`,[s,d]),c="cache_crc32",{__:r,columnHelper:n,data:o,status:E,isSuccess:w,isFetchingNextPage:S,hasNextPage:T,ref:k}=V({key:a,url:h,pageId:c,currentFilters:_,sortingColumn:d}),l={date_changed:r("Changed at"),cache_len:r("Cache size"),cache_content:r("Cache content")},x=[n.accessor("check",{className:"checkbox",cell:e=>t.createElement(y,{checked:e.row.getIsSelected(),onChange:I=>{z(I,e)}}),header:null}),n.accessor("date_changed",{cell:e=>new Date(e==null?void 0:e.getValue()).toLocaleString(window.navigator.language),header:l.date_changed,size:100}),n.accessor("cache_len",{cell:e=>`${Math.round(e.getValue()/1024,0)}Â kB`,header:l.cache_len,size:100}),n.accessor("cache_content",{tooltip:e=>t.createElement(m,null,e.getValue()),header:l.cache_content,size:500}),n.accessor("delete",{className:"deleteRow",cell:e=>t.createElement(L,{onClick:()=>b({data:o,url:h,slug:a,cell:e,rowSelector:c})}),header:null})];return E==="loading"?t.createElement(M,null):t.createElement(t.Fragment,null,t.createElement(R,{slug:a,header:l,table:u,noImport:!0,onSort:e=>f(e),onFilter:e=>p(e),exportOptions:{url:a,filters:s,fromId:`from_${c}`,pageId:c,deleteCSVCols:[c,"dest_url_id"]}}),t.createElement($,{className:"fadeInto",columns:x,slug:a,returnTable:e=>g(e),data:w&&((i=o==null?void 0:o.pages)==null?void 0:i.flatMap(e=>e??[]))},C?t.createElement(m,{center:!0},r("Content cache entry has been deleted.")):null,t.createElement("button",{ref:k},S?"Loading more...":T)))}export{O as default};
